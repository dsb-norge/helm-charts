---
suite: test cron job annotations
templates:
  - cronJob.yaml
values:
  - ./cronjob_annotations_test_values.yaml
tests:
  - it: should support custom cron job annotations
    set:
      cronJobAnnotations:
        custom-key: custom value
    asserts:
      - equal:
          path: metadata.annotations.[custom-key]
          value: custom value
  - it: should support custom cron job annotations without removing default cron job annotations
    set:
      cronJobAnnotations:
        custom-key: custom value
    asserts:
      - equal:
          path: metadata.annotations.[orgs.k8s.snyk.io/v1]
          value: "3c6b0e2e-36a2-4c0e-93c8-3ba8c87dd75d"
  - it: should support overriding default cron job annotations
    set:
      cronJobAnnotations:
        orgs.k8s.snyk.io/v1: "non-default-value"
    asserts:
      - equal:
          path: metadata.annotations.[orgs.k8s.snyk.io/v1]
          value: "non-default-value"
  - it: should support removing default cron job annotations
    set:
      cronJobAnnotations:
        orgs.k8s.snyk.io/v1: null
    asserts:
      - isNull:
          path: metadata.annotations
...